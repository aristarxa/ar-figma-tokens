# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤ Figma

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å JavaScript](#—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å-javascript)
- [–ü—Ä–æ–±–ª–µ–º—ã —Å TypeScript](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-typescript)
- [–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä—ã-–¥–∞–Ω–Ω—ã—Ö)
- [UI –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ](#ui-–∏-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
- [–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#–æ–±—â–∏–µ-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## ‚ö†Ô∏è –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å JavaScript

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Spread operator –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

**–û—à–∏–±–∫–∞**: `Syntax error on line 70: Unexpected token ...`

```javascript
// ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢ –≤ Figma
return { ...node, collapsed: true };

// ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
return Object.assign({}, node, { collapsed: true });
```

**–ü—Ä–∏—á–∏–Ω–∞**: Figma Plugin API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à—É—é –≤–µ—Ä—Å–∏—é JavaScript runtime, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ES6+ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.

**–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Object.assign()` –≤–º–µ—Å—Ç–æ spread operator.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Arrow functions –≤ closures

**–ü—Ä–æ–±–ª–µ–º–∞**: Arrow functions –≤ event handlers –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç.

```javascript
// ‚ùå –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
toggle.onclick = (e) => {
  handleToggle(node.id); // node.id –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º
};

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ IIFE
toggle.onclick = (function(nodeId) {
  return function(e) {
    e.stopPropagation();
    handleToggle(nodeId);
  };
})(node.id);
```

**–ü—Ä–∏—á–∏–Ω–∞**: –í —Ü–∏–∫–ª–∞—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ —Å—Å—ã–ª–∫–µ, –∞ –Ω–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ IIFE (Immediately Invoked Function Expression) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–º—ã–∫–∞–Ω–∏–π.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: const/let vs var

**–ü—Ä–æ–±–ª–µ–º–∞**: `const` –∏ `let` –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö.

```javascript
// ‚ùå –í–û–ó–ú–û–ñ–ù–´ –ü–†–û–ë–õ–ï–ú–´
const tree = [];
let currentNode = null;

// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û
var tree = [];
var currentNode = null;
```

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `var` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: Array methods

```javascript
// ‚úÖ –≠–¢–ò –ú–ï–¢–û–î–´ –†–ê–ë–û–¢–ê–Æ–¢
- Array.from()
- array.map()
- array.filter()
- array.find()
- array.forEach()

// ‚ö†Ô∏è –ü–†–û–í–ï–†–Ø–ô–¢–ï –ü–ï–†–ï–î –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï–ú
- array.flat()
- array.flatMap()
- Object.entries()
- Object.fromEntries()
```

---

## üö´ –ü—Ä–æ–±–ª–µ–º—ã —Å TypeScript

### –ü—Ä–æ–±–ª–µ–º–∞ 5: Exports –∏ –º–æ–¥—É–ª–∏

**–û—à–∏–±–∫–∞**: `ReferenceError: 'exports' is not defined`

```typescript
// ‚ùå –ù–ï –ö–û–ú–ü–ò–õ–ò–†–£–ï–¢–°–Ø –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
export interface TreeNode {
  id: string;
}

export function buildTree() {}
```

**–ü—Ä–∏—á–∏–Ω–∞**: Figma –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ES6 modules –∏ CommonJS exports.

**–†–µ—à–µ–Ω–∏–µ**: 
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–∏—Å—Ç—ã–π JavaScript** –±–µ–∑ –º–æ–¥—É–ª–µ–π
2. –í–µ—Å—å –∫–æ–¥ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
3. –ù–∏–∫–∞–∫–∏—Ö `import`/`export`

---

### –ü—Ä–æ–±–ª–µ–º–∞ 6: TypeScript –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏

**–û—à–∏–±–∫–∞**: `Syntax error: Unexpected token }`

```typescript
// ‚ùå –í–´–ó–´–í–ê–ï–¢ –û–®–ò–ë–ö–£
interface TreeNode {
  id: string;
  children: TreeNode[];
}

function buildTree(vars: Variable[]): TreeNode[] {}
```

**–ü—Ä–∏—á–∏–Ω–∞**: –î–∞–∂–µ –ø–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ TypeScript –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ**: –í–æ–æ–±—â–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ TypeScript –¥–ª—è Figma –ø–ª–∞–≥–∏–Ω–æ–≤. –¢–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–π ES5 JavaScript.

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–±–ª–µ–º–∞ 7: Map –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤—ã

**–û—à–∏–±–∫–∞**: `children.length = 0` –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö

```javascript
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê
var root = new Map();
root.set(path, node);
node.children = currentLevel; // Map –≤–º–µ—Å—Ç–æ Array!

// ‚úÖ –†–ï–®–ï–ù–ò–ï
var nodeMap = {}; // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ä–µ–∫—Ç
nodeMap[path] = node;
node.children = []; // –Ø–≤–Ω–æ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∞—Å—Å–∏–≤
```

**–ü—Ä–∏—á–∏–Ω–∞**: Map –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –º–∞—Å—Å–∏–≤ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –≤ UI.

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ä–µ–∫—Ç—ã `{}` –≤–º–µ—Å—Ç–æ `Map` –¥–ª—è node map, –∞ –¥–ª—è children –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Å—Å–∏–≤—ã `[]`.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 8: –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: –î–µ—Ç–∏ –Ω–µ —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –¥–µ—Ä–µ–≤–∞.

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –æ–¥–Ω–∏–º –ø—Ä–æ—Ö–æ–¥–æ–º
for (var i = 0; i < parts.length; i++) {
  currentLevel = currentLevel.get(path).children; // –¢–µ—Ä—è–µ—Ç—Å—è —Å–≤—è–∑—å
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –¥–≤–∞ –ø—Ä–æ—Ö–æ–¥–∞
// –ü—Ä–æ—Ö–æ–¥ 1: –°–æ–∑–¥–∞—Ç—å –≤—Å–µ —É–∑–ª—ã
for (var i = 0; i < variables.length; i++) {
  nodeMap[path] = node;
}

// –ü—Ä–æ—Ö–æ–¥ 2: –°–≤—è–∑–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–π —Å –¥–µ—Ç—å–º–∏
for (var path in nodeMap) {
  if (node.parentPath && nodeMap[node.parentPath]) {
    nodeMap[node.parentPath].children.push(node);
  }
}
```

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–≤—É—Ö–ø—Ä–æ—Ö–æ–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–π.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 9: –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–û—à–∏–±–∫–∞**: `cannot read property 'push' of undefined`

```javascript
// ‚ùå –ù–ï–ë–ï–ó–û–ü–ê–°–ù–û
parent.children.push(child);

// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û
if (!parent.children) {
  parent.children = [];
}
parent.children.push(child);
```

**–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ –∏ —Å–≤–æ–π—Å—Ç–≤ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 10: –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases

```javascript
// ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ü–†–û–í–ï–†–ö–ò

// 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑ –∏–º–µ–Ω–∏
if (!variable.name || typeof variable.name !== 'string') {
  console.warn('Variable without name:', variable.id);
  continue;
}

// 2. –ü—É—Å—Ç—ã–µ —á–∞—Å—Ç–∏ –∏–º–µ–Ω–∏ (–¥–≤–æ–π–Ω—ã–µ —Å–ª–µ—à–∏)
if (!part || part.trim() === '') {
  continue;
}

// 3. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–∏
if (node.parentPath && !nodeMap[node.parentPath]) {
  rootNodes.push(node); // –°–¥–µ–ª–∞—Ç—å –∫–æ—Ä–Ω–µ–≤—ã–º
}
```

---

## üé® UI –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 11: prompt() –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞**: `prompt()` –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏–ª–∏ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ Figma.

```javascript
// ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢
var choice = prompt('–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é:', '1');

// ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ - —Å–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
<div class="modal-overlay">
  <div class="modal">
    <!-- –í–∞—à UI -->
  </div>
</div>
```

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –≤ HTML/CSS.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 12: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–µ—Ä–µ–≤–∞

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–ª–∏–∫ –Ω–∞ toggle –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –≥—Ä—É–ø–ø—É.

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç currentTree
toggle.onclick = function() {
  parent.postMessage({ type: 'toggle-group', path: node.id });
  // UI –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è!
};

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ø–ª–∞–≥–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ
// –í code.js:
case 'toggle-group':
  currentTree = toggleNodeCollapsed(currentTree, msg.path);
  figma.ui.postMessage({
    type: 'tree-data',
    tree: currentTree  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ
  });
```

**–†–µ—à–µ–Ω–∏–µ**: –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –æ–±—Ä–∞—Ç–Ω–æ –≤ UI.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 13: –°–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã –≤—ã–¥–µ–ª—è—é—Ç—Å—è –¥—Ä—É–≥–∏–µ.

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö.

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –º—É—Ç–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç
function updateNode(tree, nodeId, checked) {
  node.checked = checked; // –ú—É—Ç–∞—Ü–∏—è!
  return tree;
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
function updateNode(tree, nodeId, checked) {
  return tree.map(function(node) {
    if (node.id === nodeId) {
      return Object.assign({}, node, { checked: checked });
    }
    return node;
  });
}
```

**–†–µ—à–µ–Ω–∏–µ**: –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 14: –ü–µ—Ä–µ—Å—á–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π

```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê
function updateTreeNodeChecked(tree, nodeId, checked) {
  return tree.map(function(node) {
    if (node.id === nodeId) {
      // –û–±–Ω–æ–≤–∏—Ç—å —Å–∞–º —É–∑–µ–ª –∏ –≤—Å–µ—Ö –¥–µ—Ç–µ–π
      var updated = Object.assign({}, node, { checked: checked });
      if (node.children) {
        updated.children = updateAllChildren(node.children, checked);
      }
      return updated;
    } else if (node.children) {
      // –û–±–Ω–æ–≤–∏—Ç—å –¥–µ—Ç–µ–π –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—è
      var updatedChildren = updateTreeNodeChecked(node.children, nodeId, checked);
      var checkedCount = 0;
      for (var i = 0; i < updatedChildren.length; i++) {
        if (updatedChildren[i].checked) checkedCount++;
      }
      return Object.assign({}, node, {
        children: updatedChildren,
        checked: checkedCount === updatedChildren.length,
        indeterminate: checkedCount > 0 && checkedCount < updatedChildren.length
      });
    }
    return node;
  });
}
```

---

## üìö –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚úÖ DO (–î–µ–ª–∞–π—Ç–µ)

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ES5 —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**
   - `var` –≤–º–µ—Å—Ç–æ `const/let`
   - `Object.assign()` –≤–º–µ—Å—Ç–æ spread operator
   - `function() {}` –≤–º–µ—Å—Ç–æ arrow functions
   - –û–±—ã—á–Ω—ã–µ `for` —Ü–∏–∫–ª—ã –≤–º–µ—Å—Ç–æ `for...of`

2. **–ß–∏—Å—Ç—ã–π JavaScript**
   - –ù–∏–∫–∞–∫–æ–≥–æ TypeScript
   - –ù–∏–∫–∞–∫–∏—Ö –º–æ–¥—É–ª–µ–π (import/export)
   - –í–µ—Å—å –∫–æ–¥ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ

3. **–ó–∞—â–∏—Ç–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤
   - –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ edge cases

4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ `console.log` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
   - –ü—Ä–µ—Ñ–∏–∫—Å—ã –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ª–æ–≥–æ–≤: `[Plugin]`, `[UI]`

5. **–ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å**
   - –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
   - –ù–µ –º—É—Ç–∏—Ä—É–π—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### ‚ùå DON'T (–ù–µ –¥–µ–ª–∞–π—Ç–µ)

1. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π JS**
   - Spread operator (`...`)
   - Optional chaining (`?.`)
   - Nullish coalescing (`??`)
   - Template literals –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö

2. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥—É–ª–∏**
   - ES6 modules
   - CommonJS (require/exports)
   - Dynamic imports

3. **–ù–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ API**
   - `prompt()` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - `confirm()` –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ DOM API –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã

4. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ TypeScript**
   - –î–∞–∂–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è
   - –õ—É—á—à–µ —Å—Ä–∞–∑—É –ø–∏—Å–∞—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–º JS

---

## üîß –®–∞–±–ª–æ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–¥–∞

```javascript
/**
 * –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è Figma Plugin
 */

// ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
var state = {
  tree: [],
  variables: [],
  selectedIds: []
};

// ===== –£–¢–ò–õ–ò–¢–´ =====
function safeClone(obj) {
  return JSON.parse(JSON.stringify(obj));
}

function updateObject(obj, updates) {
  return Object.assign({}, obj, updates);
}

function validateData(data) {
  if (!data || typeof data !== 'object') {
    console.warn('[Plugin] Invalid data:', data);
    return false;
  }
  return true;
}

// ===== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò =====
function handleError(error) {
  var msg = error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
  console.error('[Plugin] Error:', msg);
  figma.notify('–û—à–∏–±–∫–∞: ' + msg, { error: true });
}

// ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
figma.showUI(__html__, { width: 400, height: 600 });

figma.ui.onmessage = function(msg) {
  try {
    console.log('[Plugin] Message:', msg.type);
    
    switch (msg.type) {
      case 'action':
        // –í–∞—à –∫–æ–¥
        break;
      default:
        console.warn('[Plugin] Unknown message:', msg.type);
    }
  } catch (error) {
    handleError(error);
  }
};
```

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ ES5 —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- [ ] –ù–µ—Ç `import`/`export` statements
- [ ] –ù–µ—Ç spread operators (`...`)
- [ ] –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç IIFE –¥–ª—è closures
- [ ] –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- [ ] –ú–∞—Å—Å–∏–≤—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ `[]`, –Ω–µ `undefined`
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- [ ] –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã edge cases (–ø—É—Å—Ç—ã–µ –∏–º–µ–Ω–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–∏)
- [ ] UI –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Figma –ø–ª–∞–≥–∏–Ω–æ–≤:

1. **–ó–∞–±—É–¥—å—Ç–µ –æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º JavaScript** - –ø–∏—à–∏—Ç–µ –∫–∞–∫ –≤ 2015 –≥–æ–¥—É
2. **TypeScript - –≤—Ä–∞–≥** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —á–∏—Å—Ç—ã–π JS
3. **–ú–æ–¥—É–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç** - –≤–µ—Å—å –∫–æ–¥ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
4. **–ó–∞—â–∏—â–∞–π—Ç–µ—Å—å –æ—Ç –≤—Å–µ–≥–æ** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞–∂–¥–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ
5. **–ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∞** - –Ω–µ –º—É—Ç–∏—Ä—É–π—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
6. **–°–≤–æ–π UI –¥–ª—è –≤—Å–µ–≥–æ** - –Ω–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
7. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å—ë** - –±–µ–∑ —ç—Ç–æ–≥–æ –æ—Ç–ª–∞–¥–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞
8. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ edge cases** - –ø—É—Å—Ç—ã–µ –∏–º–µ–Ω–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

### –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:

- Figma –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π JavaScript runtime**
- –û–Ω **–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è** —Å —Ä–∞–∑–≤–∏—Ç–∏–µ–º ECMAScript
- **–ù–µ—Ç –ø–æ–ª–∏—Ñ–∏–ª–ª–æ–≤** –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Figma **–Ω–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**
- –ú–Ω–æ–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã **–ø—Ä–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ runtime**

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Figma Plugin API Documentation](https://www.figma.com/plugin-docs/)
- [MDN Web Docs - ES5](https://developer.mozilla.org/en-US/docs/Web/JavaScript)
- [Can I Use - JavaScript Features](https://caniuse.com/)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –§–µ–≤—Ä–∞–ª—å 2026  
**–ü—Ä–æ–µ–∫—Ç**: Token Manager Plugin  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: [aristarxa/ar-figma-tokens](https://github.com/aristarxa/ar-figma-tokens)
